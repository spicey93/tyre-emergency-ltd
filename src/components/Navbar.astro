---
// src/components/Navbar.astro (REFACTORED)
import { company, areas, pages } from "../data/config.json";
import { Image } from "astro:assets";
import companyLogo from "../images/logo.png";
import slug from "../utils/slug";
import { getNavServices } from "../utils/services";

const navServices = getNavServices(pages.services).map(s => ({
  title: s.title,
  href: `/services/${s.slug}`
}));
---

<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="/">
      <Image src={companyLogo} class="site-logo" alt={`${company.name} logo`} />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Services
          </a>
          <ul class="dropdown-menu">
            {navServices.map((svc) => (
              <li>
                <a class="dropdown-item" href={svc.href}>
                  {svc.title}
                </a>
              </li>
            ))}
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            href="#"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            Areas
          </a>
          <ul class="dropdown-menu">
            {areas.map((area) => (
              <li>
                <a class="dropdown-item" href={`/areas/${slug(area.name)}`}>
                  {area.name}
                </a>
              </li>
            ))}
          </ul>
        </li>
        <a
          href="/get-quote"
          class="btn btn-primary ms-lg-3 mt-2 mt-lg-0 text-light"
        >
          Get Quote
        </a>
      </ul>
    </div>
  </div>
</nav>